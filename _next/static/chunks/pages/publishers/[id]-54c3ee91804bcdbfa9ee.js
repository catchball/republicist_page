(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[935],{1680:function(r,e,n){"use strict";n.d(e,{X:function(){return s}});var t=n(6265),i=n(513);function c(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.push.apply(n,t)}return n}var s={create:function(r){return i.x.post("/publishers",function(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){(0,t.Z)(r,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}({},r))},fetchArticles:function(r){var e=r.id,n=r.isCommit;return i.x.get("/publishers/".concat(e,"/articles/new"),{params:{is_commit:n}})}}},803:function(r,e,n){"use strict";n.r(e),n.d(e,{default:function(){return D}});var t=n(5893),i=n(9999),c=n(809),s=n.n(c),o=n(6265),u=n(2447),a=n(4121),l=n(7294),p=n(5887),f=n(6829),d=n(6466),b=n(3427),h=n(9249),j=n(6146),O=n(2510),x=n(3026),g=n(1855);function v(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.push.apply(n,t)}return n}function y(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){(0,o.Z)(r,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}var m=function(r){var e=r.publisher,n=r.onPublisherChange,i=(0,l.useContext)(j.w),c=i.setError,o=i.setIsLoading,d=(0,f.useMutation)(g.T),b=(0,a.Z)(d,2),O=b[0],x=b[1].loading,v=function(){var r=(0,u.Z)(s().mark((function r(){var t,i;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==e&&void 0!==e&&e.name){r.next=3;break}return c({message:"Name is required"}),r.abrupt("return");case 3:return r.next=5,O({variables:y({},e)});case 5:t=r.sent,null!==(i=t.data)&&void 0!==i&&i.updatePublisher.publisher&&n(y(y({},e),null===i||void 0===i?void 0:i.updatePublisher.publisher)),h.Am.success("\u4fdd\u5b58\u3057\u307e\u3057\u305f");case 9:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return(0,l.useEffect)((function(){o(x)}),[x,o]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(p.zx,{onClick:v,disabled:x,children:"\u4fdd\u5b58"})})};function w(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.push.apply(n,t)}return n}function P(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){(0,o.Z)(r,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}var C=function(r){var e=r.publisher,n=r.scraping,i=r.onScrapingCreate,c=(0,l.useContext)(j.w).setIsLoading,o=(0,f.useMutation)(b.bq),d=(0,a.Z)(o,2),O=d[0],x=d[1],g=x.data,v=x.loading,y=function(){var r=(0,u.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,O({variables:P(P({},n),{},{publisherId:e.id})});case 4:g&&i(P({},g.CreateScraping.scraping)),h.Am.success("\u8ffd\u52a0\u3057\u307e\u3057\u305f");case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return(0,l.useEffect)((function(){c(v)}),[v,c]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(p.zx,{onClick:y,disabled:v,children:"\u4f5c\u6210"})})},k=n(1680);function S(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.push.apply(n,t)}return n}function E(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){(0,o.Z)(r,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}var Z=function(r){var e,n=r.id,c=(0,l.useContext)(j.w).setIsLoading,o=(0,l.useState)(null),g=o[0],v=o[1],y=(0,l.useState)(null),w=y[0],P=y[1],S=(0,f.useQuery)(d.U,{variables:{id:n}}).data,Z=(0,f.useMutation)(b.f1),D=(0,a.Z)(Z,1)[0],_=(0,f.useMutation)(b.Vk),I=(0,a.Z)(_,1)[0];(0,l.useEffect)((function(){S&&v(S.publisher)}),[S]);var A=(0,l.useState)(void 0),z=A[0],N=A[1],T=function(){var r=(0,u.Z)(s().mark((function r(e){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c(!0),r.next=3,D({variables:E({},e)});case 3:c(!1),h.Am.success("\u4fdd\u5b58\u3057\u307e\u3057\u305f");case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),$=function(){var r=(0,u.Z)(s().mark((function r(e){var n;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(g){r.next=2;break}return r.abrupt("return");case 2:return c(!0),r.next=5,I({variables:{id:e}});case 5:v(E(E({},g),{},{scrapings:(null!==(n=null===g||void 0===g?void 0:g.scrapings)&&void 0!==n?n:[]).filter((function(r){return r.id!==e}))})),c(!1),h.Am.success("\u524a\u9664\u3057\u307e\u3057\u305f");case 8:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),M=function(){var r=(0,u.Z)(s().mark((function r(e){var n,t,i;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.isCommit,g){r.next=3;break}return r.abrupt("return");case 3:return c(!0),r.next=6,k.X.fetchArticles({id:g.id,isCommit:n});case 6:t=r.sent,i=t.data,P(i),c(!1);case 10:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("main",{children:(0,t.jsx)(p.W2,{children:g&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(p.$0,{children:[(0,t.jsx)("h1",{children:g.name}),(0,t.jsx)(O.Z,{publisher:g,id:g.id,onPublisherChange:function(r){return v(E(E({},g),r))}}),(0,t.jsxs)(p.EK,{children:[(0,t.jsx)(m,{publisher:g,onPublisherChange:function(r){return v(E(E({},g),r))}}),(0,t.jsx)(p.zx,{onClick:function(){return M({isCommit:!1})},disabled:!g.rssUrl,children:"RSS\u53d6\u5f97\u30c6\u30b9\u30c8"}),(0,t.jsx)(p.zx,{onClick:function(){return M({isCommit:!0})},disabled:!g.rssUrl,children:"RSS\u53d6\u5f97"})]})]}),w&&(0,t.jsx)(p.$0,{children:(0,t.jsx)(p.iA,{className:"is-x-scrollable",children:(0,t.jsx)(p.RM,{children:w.articles.map((function(r,e){return(0,t.jsxs)(p.SC,{children:[(0,t.jsx)(p.C5,{children:(0,t.jsx)("small",{children:r.publishDate})}),(0,t.jsx)(p.C5,{children:(0,t.jsx)("small",{children:r.title})}),(0,t.jsx)(p.C5,{children:(0,t.jsx)("small",{children:r.url})}),(0,t.jsx)(p.C5,{children:(0,t.jsx)("small",{children:r.content})})]},e)}))})})}),(0,t.jsx)(p.$0,{children:(0,t.jsx)("h2",{children:"\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u30eb\u30fc\u30eb"})}),null===(e=g.scrapings)||void 0===e?void 0:e.map((function(r){return(0,t.jsxs)(p.$0,{children:[(0,t.jsxs)("h3",{children:["Scraping::",r.publisherId,"::",r.id]}),(0,t.jsx)("p",{children:r.description}),(0,t.jsx)(x.Z,{scraping:r,onScrapingChange:function(e){return v(E(E({},g),{},{scrapings:[].concat((0,i.Z)((g.scrapings||[]).filter((function(e){return e.id!=r.id}))),[E(E({},r),e)]).sort((function(r,e){return r.id<e.id?-1:1}))}))},scrapingId:r.id}),(0,t.jsxs)(p.EK,{children:[(0,t.jsx)(p.zx,{onClick:function(){return T(r)},children:"\u4fdd\u5b58"}),(0,t.jsx)(p.zx,{onClick:function(){return $(r.id)},children:"\u524a\u9664"})]})]},r.id)})),z?(0,t.jsxs)(p.$0,{children:[(0,t.jsx)("h3",{children:"\u65b0\u898f\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u30eb\u30fc\u30eb"}),(0,t.jsx)(x.Z,{scraping:z,onScrapingChange:function(r){return N(r)},scrapingId:0}),(0,t.jsxs)(p.EK,{children:[(0,t.jsx)(C,{scraping:z,publisher:g,onScrapingCreate:function(r){var e;N(void 0),v(E(E({},g),{},{scrapings:[].concat((0,i.Z)(null!==(e=g.scrapings)&&void 0!==e?e:[]),[r])}))}}),(0,t.jsx)(p.zx,{onClick:function(){return N(void 0)},className:"cancel",children:"\u30ad\u30e3\u30f3\u30bb\u30eb"})]})]}):(0,t.jsx)(p.$0,{children:(0,t.jsx)(p.EK,{children:(0,t.jsx)(p.zx,{onClick:function(){return N({processor:"lxml"})},children:"\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u30eb\u30fc\u30eb\u306e\u8ffd\u52a0"})})})]})})})})};Z.getInitialProps=function(r){var e=r.query;return{id:parseInt(e.id&&"string"===typeof e.id?e.id:""),fallback:"blocking"}};var D=Z},513:function(r,e,n){"use strict";n.d(e,{x:function(){return a}});var t=n(6265),i=n(9669),c=n.n(i),s=n(1745);function o(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.push.apply(n,t)}return n}function u(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){(0,t.Z)(r,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}var a=c().create({baseURL:"".concat("https://republicist-api.reload.co.jp","/api/v1/"),responseType:"json",headers:{"Content-Type":"application/json"}});a.interceptors.request.use((function(r){return u(u({},r),{},{data:(0,s.toSnake)(r.data)})})),a.interceptors.response.use((function(r){return u(u({},r),{},{data:(0,s.toCamel)(r.data)})}),(function(r){return Promise.reject(r)}))},6088:function(r,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/publishers/[id]",function(){return n(803)}])},9999:function(r,e,n){"use strict";n.d(e,{Z:function(){return c}});var t=n(5093);var i=n(355);function c(r){return function(r){if(Array.isArray(r))return(0,t.Z)(r)}(r)||function(r){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}(r)||(0,i.Z)(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}},function(r){r.O(0,[637,581,774,888,179],(function(){return e=6088,r(r.s=e);var e}));var e=r.O();_N_E=e}]);