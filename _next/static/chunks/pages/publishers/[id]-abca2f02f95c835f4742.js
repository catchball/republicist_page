(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[935],{1680:function(r,e,t){"use strict";t.d(e,{X:function(){return s}});var n=t(6265),i=t(513);function c(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}var s={create:function(r){return i.x.post("/publishers",function(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?c(Object(t),!0).forEach((function(e){(0,n.Z)(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}({},r))},fetchArticles:function(r){var e=r.id,t=r.isCommit;return i.x.get("/publishers/".concat(e,"/articles/new"),{params:{is_commit:t}})}}},803:function(r,e,t){"use strict";t.r(e),t.d(e,{default:function(){return _}});var n=t(5893),i=t(8140),c=t(809),s=t.n(c),o=t(6265),u=t(2447),a=t(2292),l=t(7294),p=t(1664),f=t(5887),d=t(6829),b=t(6466),h=t(3427),j=t(9249),O=t(6146),x=t(2510),v=t(3026),g=t(1855);function y(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}function m(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?y(Object(t),!0).forEach((function(e){(0,o.Z)(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}var w=function(r){var e=r.publisher,t=r.onPublisherChange,i=(0,l.useContext)(O.w),c=i.setError,o=i.setIsLoading,p=(0,d.useMutation)(g.T),b=(0,a.Z)(p,2),h=b[0],x=b[1].loading,v=function(){var r=(0,u.Z)(s().mark((function r(){var n,i;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==e&&void 0!==e&&e.name){r.next=3;break}return c({message:"Name is required"}),r.abrupt("return");case 3:return r.next=5,h({variables:m({},e)});case 5:n=r.sent,null!==(i=n.data)&&void 0!==i&&i.updatePublisher.publisher&&t(m(m({},e),null===i||void 0===i?void 0:i.updatePublisher.publisher)),j.Am.success("\u4fdd\u5b58\u3057\u307e\u3057\u305f");case 9:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return(0,l.useEffect)((function(){o(x)}),[x,o]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(f.zx,{onClick:v,disabled:x,children:"\u4fdd\u5b58"})})};function P(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}function k(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?P(Object(t),!0).forEach((function(e){(0,o.Z)(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}var C=function(r){var e=r.publisher,t=r.scraping,i=r.onScrapingCreate,c=(0,l.useContext)(O.w).setIsLoading,o=(0,d.useMutation)(h.bq),p=(0,a.Z)(o,2),b=p[0],x=p[1],v=x.data,g=x.loading,y=function(){var r=(0,u.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,b({variables:k(k({},t),{},{publisherId:e.id})});case 4:v&&i(k({},v.CreateScraping.scraping)),j.Am.success("\u8ffd\u52a0\u3057\u307e\u3057\u305f");case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return(0,l.useEffect)((function(){c(g)}),[g,c]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(f.zx,{onClick:y,disabled:g,children:"\u4f5c\u6210"})})},E=t(1680);function S(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}function Z(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?S(Object(t),!0).forEach((function(e){(0,o.Z)(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}var D=function(r){var e,t=r.id,c=(0,l.useContext)(O.w),o=c.setIsLoading,g=c.setError,y=(0,l.useState)(null),m=y[0],P=y[1],k=(0,l.useState)(null),S=k[0],D=k[1],_=(0,d.useQuery)(b.U,{variables:{id:t}}).data,I=(0,d.useMutation)(h.f1),A=(0,a.Z)(I,1)[0],z=(0,d.useMutation)(h.Vk),L=(0,a.Z)(z,1)[0];(0,l.useEffect)((function(){_&&P(_.publisher)}),[_]);var N=(0,l.useState)(void 0),T=N[0],U=N[1],X=function(){var r=(0,u.Z)(s().mark((function r(e){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o(!0),r.next=3,A({variables:Z({},e)});case 3:o(!1),j.Am.success("\u4fdd\u5b58\u3057\u307e\u3057\u305f");case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),$=function(){var r=(0,u.Z)(s().mark((function r(e){var t;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(m){r.next=2;break}return r.abrupt("return");case 2:return o(!0),r.next=5,L({variables:{id:e}});case 5:P(Z(Z({},m),{},{scrapings:(null!==(t=null===m||void 0===m?void 0:m.scrapings)&&void 0!==t?t:[]).filter((function(r){return r.id!==e}))})),o(!1),j.Am.success("\u524a\u9664\u3057\u307e\u3057\u305f");case 8:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),M=function(){var r=(0,u.Z)(s().mark((function r(e){var t,n,i;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=e.isCommit,m){r.next=3;break}return r.abrupt("return");case 3:return r.prev=3,o(!0),r.next=7,E.X.fetchArticles({id:m.id,isCommit:t});case 7:n=r.sent,i=n.data,D(i),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(3),r.t0 instanceof Error?g(r.t0):g({message:"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f: ".concat(r.t0)});case 15:return r.prev=15,o(!1),r.finish(15);case 18:case"end":return r.stop()}}),r,null,[[3,12,15,18]])})));return function(e){return r.apply(this,arguments)}}();return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("main",{children:(0,n.jsx)(f.W2,{children:m&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(f.$0,{children:[(0,n.jsx)("h1",{children:m.name}),(0,n.jsx)(x.Z,{publisher:m,id:m.id,onPublisherChange:function(r){return P(Z(Z({},m),r))}}),(0,n.jsxs)(f.EK,{children:[(0,n.jsx)(p.default,{href:"/articles?publisherId=".concat(m.id),children:(0,n.jsx)(f.zx,{children:"\u8a18\u4e8b\u4e00\u89a7"})}),(0,n.jsx)(w,{publisher:m,onPublisherChange:function(r){return P(Z(Z({},m),r))}}),(0,n.jsx)(f.zx,{onClick:function(){return M({isCommit:!1})},disabled:!m.rssUrl&&(!m.articleListUrl||!m.articleLinkXpath),children:"\u8a18\u4e8b\u4e00\u89a7\u53d6\u5f97\u30c6\u30b9\u30c8"}),(0,n.jsx)(f.zx,{onClick:function(){return M({isCommit:!0})},disabled:!m.rssUrl&&(!m.articleListUrl||!m.articleLinkXpath),children:"\u8a18\u4e8b\u4e00\u89a7\u53d6\u5f97"})]})]}),S&&(0,n.jsx)(f.$0,{children:(0,n.jsx)(f.iA,{className:"is-x-scrollable",children:(0,n.jsx)(f.RM,{children:S.articles.map((function(r,e){return(0,n.jsxs)(f.SC,{children:[(0,n.jsx)(f.C5,{children:(0,n.jsx)("small",{children:r.publishDate})}),(0,n.jsx)(f.C5,{children:(0,n.jsx)("small",{children:r.title})}),(0,n.jsx)(f.C5,{children:(0,n.jsx)("small",{children:r.url})}),(0,n.jsx)(f.C5,{children:(0,n.jsx)("small",{children:r.content})})]},e)}))})})}),(0,n.jsx)(f.$0,{children:(0,n.jsx)("h2",{children:"\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u30eb\u30fc\u30eb"})}),null===(e=m.scrapings)||void 0===e?void 0:e.map((function(r){return(0,n.jsxs)(f.$0,{children:[(0,n.jsxs)("h3",{children:["Scraping::",r.publisherId,"::",r.id]}),(0,n.jsx)("p",{children:r.description}),(0,n.jsx)(v.Z,{scraping:r,onScrapingChange:function(e){return P(Z(Z({},m),{},{scrapings:[].concat((0,i.Z)((m.scrapings||[]).filter((function(e){return e.id!=r.id}))),[Z(Z({},r),e)]).sort((function(r,e){return r.id<e.id?-1:1}))}))},scrapingId:r.id}),(0,n.jsxs)(f.EK,{children:[(0,n.jsx)(f.zx,{onClick:function(){return X(r)},children:"\u4fdd\u5b58"}),(0,n.jsx)(f.zx,{onClick:function(){return $(r.id)},children:"\u524a\u9664"})]})]},r.id)})),T?(0,n.jsxs)(f.$0,{children:[(0,n.jsx)("h3",{children:"\u65b0\u898f\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u30eb\u30fc\u30eb"}),(0,n.jsx)(v.Z,{scraping:T,onScrapingChange:function(r){return U(r)},scrapingId:0}),(0,n.jsxs)(f.EK,{children:[(0,n.jsx)(C,{scraping:T,publisher:m,onScrapingCreate:function(r){var e;U(void 0),P(Z(Z({},m),{},{scrapings:[].concat((0,i.Z)(null!==(e=m.scrapings)&&void 0!==e?e:[]),[r])}))}}),(0,n.jsx)(f.zx,{onClick:function(){return U(void 0)},className:"cancel",children:"\u30ad\u30e3\u30f3\u30bb\u30eb"})]})]}):(0,n.jsx)(f.$0,{children:(0,n.jsx)(f.EK,{children:(0,n.jsx)(f.zx,{onClick:function(){return U({processor:"lxml"})},children:"\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u30eb\u30fc\u30eb\u306e\u8ffd\u52a0"})})})]})})})})};D.getInitialProps=function(r){var e=r.query;return{id:parseInt(e.id&&"string"===typeof e.id?e.id:""),fallback:"blocking"}};var _=D},513:function(r,e,t){"use strict";t.d(e,{x:function(){return a}});var n=t(6265),i=t(9669),c=t.n(i),s=t(1745);function o(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}function u(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?o(Object(t),!0).forEach((function(e){(0,n.Z)(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}var a=c().create({baseURL:"".concat("https://republicist-api.reload.co.jp","/api/v1/"),responseType:"json",headers:{"Content-Type":"application/json"}});a.interceptors.request.use((function(r){return u(u({},r),{},{data:(0,s.toSnake)(r.data)})})),a.interceptors.response.use((function(r){return u(u({},r),{},{data:(0,s.toCamel)(r.data)})}),(function(r){return Promise.reject(r)}))},6088:function(r,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/publishers/[id]",function(){return t(803)}])},9391:function(r,e,t){"use strict";function n(r){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}t.d(e,{Z:function(){return n}})},8140:function(r,e,t){"use strict";t.d(e,{Z:function(){return s}});var n=t(5093);var i=t(9391),c=t(355);function s(r){return function(r){if(Array.isArray(r))return(0,n.Z)(r)}(r)||(0,i.Z)(r)||(0,c.Z)(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}},function(r){r.O(0,[637,581,774,888,179],(function(){return e=6088,r(r.s=e);var e}));var e=r.O();_N_E=e}]);